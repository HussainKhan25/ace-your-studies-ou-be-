<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Quest - Educational Treasure Hunt | AceYourStudies:OU [BE]</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0D1B2A 0%, #1a2332 50%, #0D1B2A 100%);
            color: #FFFFFF;
            overflow: hidden;
            position: relative;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0D1B2A 0%, #1a2332 50%, #0D1B2A 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1.5s ease-out;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-content {
            text-align: center;
            max-width: 90%;
            padding: 2rem;
        }

        .game-logo {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: bold;
            background: linear-gradient(45deg, #FFC107, #FFD700, #FF8F00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            text-shadow: 0 0 30px rgba(255, 193, 7, 0.5);
            animation: logoGlow 2s ease-in-out infinite alternate;
        }

        @keyframes logoGlow {
            from { filter: drop-shadow(0 0 10px rgba(255, 193, 7, 0.5)); }
            to { filter: drop-shadow(0 0 20px rgba(255, 193, 7, 0.8)); }
        }

        .loading-subtitle {
            font-size: clamp(1rem, 2vw, 1.3rem);
            color: #CCCCCC;
            margin-bottom: 2rem;
            font-style: italic;
        }

        .quest-briefing {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 193, 7, 0.3);
            animation: briefingGlow 3s ease-in-out infinite alternate;
            max-width: 600px;
        }

        @keyframes briefingGlow {
            from { box-shadow: 0 0 20px rgba(255, 193, 7, 0.2); }
            to { box-shadow: 0 0 40px rgba(255, 193, 7, 0.4); }
        }

        .briefing-text {
            font-size: clamp(1rem, 2vw, 1.1rem);
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .loading-progress {
            width: min(350px, 80vw);
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            margin: 2rem auto;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #FFC107, #FFD700, #FF8F00);
            border-radius: 3px;
            animation: loading 4s ease-in-out;
            transform: translateX(-100%);
        }

        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(0%); }
        }

        /* Navigation */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1rem 2rem;
            background: rgba(13, 27, 42, 0.95);
            backdrop-filter: blur(15px);
            z-index: 100;
            border-bottom: 1px solid rgba(255, 193, 7, 0.3);
            transition: all 0.3s ease;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        .logo {
            font-size: 1.2rem;
            font-weight: bold;
            color: #FFC107;
            text-decoration: none;
            text-shadow: 0 0 15px rgba(255, 193, 7, 0.5);
            z-index: 101;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
            transition: all 0.3s ease;
        }

        .nav-links a {
            color: #FFFFFF;
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav-links a:hover, .nav-links a.active {
            color: #FFC107;
            text-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        .nav-toggle {
            display: none;
            background: linear-gradient(135deg, #FFC107, #FFB300);
            color: #0D1B2A;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 101;
        }

        .nav-toggle:hover {
            background: linear-gradient(135deg, #FFB300, #FF8F00);
            transform: scale(1.05);
        }

        /* Game Container */
        .game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            padding-top: 80px;
        }

        /* Game Canvas */
        .game-canvas {
            position: relative;
            width: min(800px, 100vw);
            height: min(600px, calc(100vh - 120px));
            margin: 0 auto;
            background: linear-gradient(135deg, #1a2332 0%, #2a3c4a 50%, #1a2332 100%);
            border: 3px solid #FFC107;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 193, 7, 0.3);
            overflow: hidden;
        }

        /* Game Grid */
        .game-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(8, 1fr);
            width: 100%;
            height: 100%;
            gap: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        .grid-cell {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            transition: all 0.3s ease;
        }

        .grid-cell.wall {
            background: linear-gradient(135deg, #374151, #4b5563);
            border-color: #6b7280;
        }

        .grid-cell.path {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }

        /* Player */
        .player {
            position: absolute;
            width: 80%;
            height: 80%;
            top: 10%;
            left: 10%;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            text-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
            transition: all 0.3s ease;
            z-index: 10;
        }

        .player.moving {
            transform: scale(1.1);
        }

        /* Keys */
        .key {
            position: absolute;
            width: 70%;
            height: 70%;
            top: 15%;
            left: 15%;
            background: linear-gradient(135deg, #FFC107, #FFD700);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #0D1B2A;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.5);
            animation: keyGlow 2s ease-in-out infinite alternate;
        }

        @keyframes keyGlow {
            from { box-shadow: 0 0 15px rgba(255, 193, 7, 0.5); }
            to { box-shadow: 0 0 25px rgba(255, 193, 7, 0.8); }
        }

        /* Goal */
        .goal {
            position: absolute;
            width: 90%;
            height: 90%;
            top: 5%;
            left: 5%;
            background: linear-gradient(135deg, #e11d48, #be185d);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            text-shadow: 0 0 10px rgba(190, 24, 93, 0.5);
            box-shadow: 0 0 20px rgba(190, 24, 93, 0.4);
            animation: goalPulse 1.5s ease-in-out infinite alternate;
        }

        @keyframes goalPulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        /* Game UI */
        .game-ui {
            position: fixed;
            top: 90px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 50;
        }

        .score-panel {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem 1.5rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .score-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .score-item:last-child {
            margin-bottom: 0;
        }

        .controls-hint {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 193, 7, 0.3);
            text-align: center;
            font-size: 0.9rem;
        }

        /* Question Modal */
        .question-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .question-modal.show {
            opacity: 1;
            pointer-events: all;
        }

        .question-content {
            background: linear-gradient(135deg, #1e3a8a, #1d4ed8);
            padding: 2rem;
            border-radius: 20px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 2px solid #FFC107;
            position: relative;
        }

        .question-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .question-subject {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 1rem;
            display: inline-block;
        }

        .question-text {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            color: #e0e7ff;
        }

        .options-container {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .option {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #FFFFFF;
        }

        .option:hover {
            background: rgba(255, 193, 7, 0.2);
            border-color: rgba(255, 193, 7, 0.5);
            transform: translateY(-2px);
        }

        .option.selected {
            background: rgba(16, 185, 129, 0.3);
            border-color: #10b981;
        }

        .option.correct {
            background: rgba(16, 185, 129, 0.4);
            border-color: #10b981;
        }

        .option.incorrect {
            background: rgba(239, 68, 68, 0.4);
            border-color: #ef4444;
        }

        .question-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FFC107, #FFB300);
            color: #0D1B2A;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #FFB300, #FF8F00);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: #FFFFFF;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Success Modal */
        .success-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 300;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .success-modal.show {
            opacity: 1;
            pointer-events: all;
        }

        .success-content {
            background: linear-gradient(135deg, #059669, #10b981);
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 3px solid #FFC107;
            position: relative;
            overflow: hidden;
        }

        .success-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: successShine 2s ease-in-out infinite;
        }

        @keyframes successShine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .success-title {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #FFC107;
        }

        .success-message {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            color: #FFFFFF;
        }

        .success-stats {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .success-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Mobile Controls */
        .mobile-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            z-index: 50;
        }

        .control-pad {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
            gap: 5px;
            width: 150px;
            height: 150px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.5);
            border-radius: 10px;
            color: #FFC107;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
        }

        .control-btn:active {
            background: rgba(255, 193, 7, 0.3);
            transform: scale(0.95);
        }

        .control-btn.up { grid-column: 2; grid-row: 1; }
        .control-btn.left { grid-column: 1; grid-row: 2; }
        .control-btn.right { grid-column: 3; grid-row: 2; }
        .control-btn.down { grid-column: 2; grid-row: 3; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav {
                padding: 1rem;
            }

            .nav-links {
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(13, 27, 42, 0.98);
                backdrop-filter: blur(15px);
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                border-bottom: 1px solid rgba(255, 193, 7, 0.3);
            }

            .nav-links.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }

            .nav-links a {
                font-size: 1rem;
                padding: 0.5rem;
                text-align: center;
                border-radius: 8px;
            }

            .nav-toggle {
                display: block;
            }

            .game-canvas {
                width: 95vw;
                height: calc(100vh - 200px);
            }

            .game-ui {
                flex-direction: column;
                gap: 1rem;
                position: static;
                margin: 1rem;
            }

            .mobile-controls {
                display: block;
            }

            .controls-hint {
                display: none;
            }

            .question-content {
                padding: 1.5rem;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .success-content {
                padding: 2rem;
                margin: 1rem;
            }

            .success-title {
                font-size: 2rem;
            }

            .success-message {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 480px) {
            .game-canvas {
                height: calc(100vh - 250px);
            }

            .control-pad {
                width: 120px;
                height: 120px;
            }

            .control-btn {
                font-size: 1.2rem;
            }
        }

        /* Animations */
        @keyframes collectKey {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.5) rotate(180deg); }
            100% { transform: scale(0) rotate(360deg); }
        }

        .key.collected {
            animation: collectKey 0.5s ease-in-out;
        }

        /* Confetti Animation */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #FFC107;
            animation: confetti-fall 3s linear infinite;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="game-logo">🎮 Knowledge Quest</div>
            <div class="loading-subtitle">Educational Treasure Hunt Adventure</div>
            
            <div class="quest-briefing">
                <div class="briefing-text">
                    <strong>Mission Briefing:</strong><br>
                    Navigate through the maze, collect golden keys by answering challenging questions across multiple engineering subjects, and reach the treasure goal!
                </div>
                <div class="briefing-text">
                    <strong>Subjects:</strong> Digital Electronics, Data Structures, AI/ML, Cybersecurity, and more!
                </div>
                
                <div class="loading-progress">
                    <div class="progress-bar"></div>
                </div>
                
                <div class="briefing-text" style="font-style: italic; color: #FFC107;">
                    Preparing your adventure... Get ready to test your knowledge! 🚀
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <a href="#" class="logo">AceYourStudies:OU [BE]</a>
            <button class="nav-toggle" id="navToggle">☰</button>
            <ul class="nav-links" id="navLinks">
                <li><a href="index.html">Home</a></li>
                <li><a href="knowledge.html" class="active">Knowledge Quest</a></li>
                <li><a href="quest.html">Study Quest</a></li>
            </ul>
        </div>
    </nav>

    <!-- Game Container -->
    <div class="game-container">
        <!-- Game UI -->
        <div class="game-ui">
            <div class="score-panel">
                <div class="score-item">
                    <span>🔑</span>
                    <span>Keys: <span id="keysCollected">0</span>/5</span>
                </div>
                <div class="score-item">
                    <span>💯</span>
                    <span>Score: <span id="gameScore">0</span></span>
                </div>
                <div class="score-item">
                    <span>⏱️</span>
                    <span>Time: <span id="gameTime">00:00</span></span>
                </div>
            </div>
            
            <div class="controls-hint">
                <div>Use Arrow Keys or WASD to move</div>
                <div>Collect keys by answering questions!</div>
            </div>
        </div>

        <!-- Game Canvas -->
        <div class="game-canvas">
            <div class="game-grid" id="gameGrid">
                <!-- Grid cells will be generated by JavaScript -->
            </div>
        </div>

        <!-- Mobile Controls -->
        <div class="mobile-controls">
            <div class="control-pad">
                <div class="control-btn up" data-direction="up">↑</div>
                <div class="control-btn left" data-direction="left">←</div>
                <div class="control-btn right" data-direction="right">→</div>
                <div class="control-btn down" data-direction="down">↓</div>
            </div>
        </div>
    </div>

    <!-- Question Modal -->
    <div class="question-modal" id="questionModal">
        <div class="question-content">
            <div class="question-header">
                <div class="question-subject" id="questionSubject"></div>
                <div class="question-text" id="questionText"></div>
            </div>
            
            <div class="options-container" id="optionsContainer">
                <!-- Options will be generated by JavaScript -->
            </div>
            
            <div class="question-buttons">
                <button class="btn btn-primary" id="submitAnswer" disabled>Submit Answer</button>
                <button class="btn btn-secondary" id="skipQuestion">Skip Question</button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="success-modal" id="successModal">
        <div class="success-content">
            <div class="success-title">🏆 Congratulations!</div>
            <div class="success-message">You've completed the Knowledge Quest!</div>
            
            <div class="success-stats">
                <div>Keys Collected: <span id="finalKeys"></span>/5</div>
                <div>Final Score: <span id="finalScore"></span></div>
                <div>Time Taken: <span id="finalTime"></span></div>
                <div>Accuracy: <span id="finalAccuracy"></span>%</div>
            </div>
            
            <div class="success-buttons">
                <button class="btn btn-primary" onclick="restartGame()">Try Again</button>
                <button class="btn btn-secondary" onclick="goHome()">Back to Home</button>
            </div>
        </div>
    </div>

    <script>
        // Game Configuration
        const GRID_WIDTH = 10;
        const GRID_HEIGHT = 8;
        
        // Game State
        let gameState = {
            player: { x: 0, y: 0 },
            keys: [],
            keysCollected: 0,
            score: 0,
            startTime: null,
            gameTime: 0,
            currentQuestion: null,
            questionsAnswered: 0,
            correctAnswers: 0,
            gameWon: false
        };

        // Questions Database
        const questionsDB = {
            "Digital Electronics": [
                {
                    question: "What is the Boolean expression for NAND gate?",
                    options: ["A.B", "A+B", "!(A.B)", "!(A+B)"],
                    correct: 2
                },
                {
                    question: "How many flip-flops are required to construct a MOD-16 counter?",
                    options: ["2", "3", "4", "5"],
                    correct: 2
                },
                {
                    question: "Which logic family has the lowest power consumption?",
                    options: ["TTL", "CMOS", "ECL", "IIL"],
                    correct: 1
                }
            ],
            "Data Structures": [
                {
                    question: "What is the time complexity of binary search?",
                    options: ["O(n)", "O(log n)", "O(n log n)", "O(n²)"],
                    correct: 1
                },
                {
                    question: "Which data structure uses LIFO principle?",
                    options: ["Queue", "Stack", "Array", "Linked List"],
                    correct: 1
                },
                {
                    question: "What is the worst-case time complexity of QuickSort?",
                    options: ["O(n log n)", "O(n²)", "O(n)", "O(log n)"],
                    correct: 1
                }
            ],
            "Artificial Intelligence": [
                {
                    question: "What is the main goal of AI?",
                    options: ["Data Storage", "Machine Simulation of Human Intelligence", "Network Security", "Database Management"],
                    correct: 1
                },
                {
                    question: "Which algorithm is used for pathfinding in AI?",
                    options: ["Bubble Sort", "A* Algorithm", "Linear Search", "Merge Sort"],
                    correct: 1
                },
                {
                    question: "What does NLP stand for in AI?",
                    options: ["Natural Language Processing", "Network Layer Protocol", "New Logic Programming", "Neural Learning Process"],
                    correct: 0
                }
            ],
            "Machine Learning": [
                {
                    question: "What type of learning uses labeled training data?",
                    options: ["Unsupervised Learning", "Supervised Learning", "Reinforcement Learning", "Deep Learning"],
                    correct: 1
                },
                {
                    question: "Which algorithm is used for classification problems?",
                    options: ["K-Means", "Decision Tree", "DBSCAN", "PCA"],
                    correct: 1
                },
                {
                    question: "What is overfitting in machine learning?",
                    options: ["Model performs well on training data but poorly on test data", "Model performs poorly on all data", "Model is too simple", "Model trains too fast"],
                    correct: 0
                }
            ],
            "Computer Networks": [
                {
                    question: "Which layer of OSI model handles routing?",
                    options: ["Physical Layer", "Data Link Layer", "Network Layer", "Transport Layer"],
                    correct: 2
                },
                {
                    question: "What is the default port number for HTTP?",
                    options: ["21", "25", "80", "443"],
                    correct: 2
                },
                {
                    question: "Which protocol is used for email transmission?",
                    options: ["HTTP", "FTP", "SMTP", "DNS"],
                    correct: 2
                }
            ],
            "Cybersecurity": [
                {
                    question: "What does CIA triad stand for in cybersecurity?",
                    options: ["Control, Integrity, Authentication", "Confidentiality, Integrity, Availability", "Cyber, Information, Access", "Certificate, Identity, Authorization"],
                    correct: 1
                },
                {
                    question: "Which type of attack involves overwhelming a server with traffic?",
                    options: ["Phishing", "SQL Injection", "DDoS", "Man-in-the-Middle"],
                    correct: 2
                },
                {
                    question: "What is two-factor authentication?",
                    options: ["Using two passwords", "Using password and biometric/token", "Using two usernames", "Using two browsers"],
                    correct: 1
                }
            ],
            "Signal and System": [
                {
                    question: "What is the Laplace transform of unit step function?",
                    options: ["1/s", "s", "1", "s²"],
                    correct: 0
                },
                {
                    question: "A system is stable if all poles are located in:",
                    options: ["Right half of s-plane", "Left half of s-plane", "Imaginary axis", "Origin"],
                    correct: 1
                },
                {
                    question: "What is the fundamental period of sin(2πt)?",
                    options: ["1", "2π", "π", "2"],
                    correct: 0
                }
            ],
            "Discrete Mathematics": [
                {
                    question: "How many edges does a complete graph with n vertices have?",
                    options: ["n", "n-1", "n(n-1)/2", "n²"],
                    correct: 2
                },
                {
                    question: "What is the contrapositive of 'If P then Q'?",
                    options: ["If Q then P", "If not P then not Q", "If not Q then not P", "P if and only if Q"],
                    correct: 2
                },
                {
                    question: "A tree with n vertices has how many edges?",
                    options: ["n", "n-1", "n+1", "2n"],
                    correct: 1
                }
            ],
            "Software Engineering": [
                {
                    question: "Which SDLC model follows linear sequential approach?",
                    options: ["Agile", "Waterfall", "Spiral", "RAD"],
                    correct: 1
                },
                {
                    question: "What is the purpose of unit testing?",
                    options: ["Test individual components", "Test complete system", "Test user interface", "Test database"],
                    correct: 0
                },
                {
                    question: "Which diagram shows the dynamic behavior of objects?",
                    options: ["Class Diagram", "Use Case Diagram", "Sequence Diagram", "Component Diagram"],
                    correct: 2
                }
            ]
        };

        // Game Map Layout (0 = wall, 1 = path, 2 = key, 3 = goal)
        const gameMap = [
            [1, 1, 0, 1, 2, 1, 0, 1, 1, 1],
            [0, 1, 0, 1, 0, 1, 0, 1, 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 0, 1],
            [1, 0, 0, 2, 0, 0, 0, 1, 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [0, 1, 0, 2, 0, 1, 0, 0, 0, 1],
            [1, 1, 0, 1, 0, 1, 1, 2, 1, 1],
            [2, 1, 1, 1, 1, 1, 0, 1, 1, 3]
        ];

        // Initialize Game
        function initGame() {
            createGameGrid();
            spawnPlayer();
            spawnKeys();
            spawnGoal();
            startGameTimer();
            updateUI();
        }

        // Create Game Grid
        function createGameGrid() {
            const gameGrid = document.getElementById('gameGrid');
            gameGrid.innerHTML = '';
            
            for (let y = 0; y < GRID_HEIGHT; y++) {
                for (let x = 0; x < GRID_WIDTH; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'grid-cell';
                    cell.id = `cell-${x}-${y}`;
                    
                    if (gameMap[y][x] === 0) {
                        cell.classList.add('wall');
                    } else {
                        cell.classList.add('path');
                    }
                    
                    gameGrid.appendChild(cell);
                }
            }
        }

        // Spawn Player
        function spawnPlayer() {
            gameState.player = { x: 0, y: 0 };
            const playerElement = document.createElement('div');
            playerElement.className = 'player';
            playerElement.id = 'player';
            playerElement.innerHTML = '👤';
            
            const cell = document.getElementById(`cell-0-0`);
            cell.appendChild(playerElement);
        }

        // Spawn Keys
        function spawnKeys() {
            gameState.keys = [];
            const subjects = Object.keys(questionsDB);
            
            for (let y = 0; y < GRID_HEIGHT; y++) {
                for (let x = 0; x < GRID_WIDTH; x++) {
                    if (gameMap[y][x] === 2) {
                        const keyElement = document.createElement('div');
                        keyElement.className = 'key';
                        keyElement.id = `key-${x}-${y}`;
                        keyElement.innerHTML = '🔑';
                        
                        const subject = subjects[gameState.keys.length % subjects.length];
                        keyElement.dataset.subject = subject;
                        
                        const cell = document.getElementById(`cell-${x}-${y}`);
                        cell.appendChild(keyElement);
                        
                        gameState.keys.push({ x, y, subject, collected: false });
                    }
                }
            }
        }

        // Spawn Goal
        function spawnGoal() {
            for (let y = 0; y < GRID_HEIGHT; y++) {
                for (let x = 0; x < GRID_WIDTH; x++) {
                    if (gameMap[y][x] === 3) {
                        const goalElement = document.createElement('div');
                        goalElement.className = 'goal';
                        goalElement.id = 'goal';
                        goalElement.innerHTML = '🏆';
                        
                        const cell = document.getElementById(`cell-${x}-${y}`);
                        cell.appendChild(goalElement);
                    }
                }
            }
        }

        // Move Player
        function movePlayer(direction) {
            const { x, y } = gameState.player;
            let newX = x;
            let newY = y;
            
            switch (direction) {
                case 'up':
                    newY = Math.max(0, y - 1);
                    break;
                case 'down':
                    newY = Math.min(GRID_HEIGHT - 1, y + 1);
                    break;
                case 'left':
                    newX = Math.max(0, x - 1);
                    break;
                case 'right':
                    newX = Math.min(GRID_WIDTH - 1, x + 1);
                    break;
            }
            
            // Check if move is valid (not a wall)
            if (gameMap[newY][newX] !== 0) {
                const playerElement = document.getElementById('player');
                const oldCell = document.getElementById(`cell-${x}-${y}`);
                const newCell = document.getElementById(`cell-${newX}-${newY}`);
                
                // Add moving animation
                playerElement.classList.add('moving');
                setTimeout(() => playerElement.classList.remove('moving'), 300);
                
                // Move player
                oldCell.removeChild(playerElement);
                newCell.appendChild(playerElement);
                
                gameState.player = { x: newX, y: newY };
                
                // Check for key collision
                checkKeyCollision(newX, newY);
                
                // Check for goal collision
                checkGoalCollision(newX, newY);
            }
        }

        // Check Key Collision
        function checkKeyCollision(x, y) {
            for (let i = 0; i < gameState.keys.length; i++) {
                const key = gameState.keys[i];
                if (key.x === x && key.y === y && !key.collected) {
                    showQuestion(key.subject, i);
                    break;
                }
            }
        }

        // Check Goal Collision
        function checkGoalCollision(x, y) {
            if (gameMap[y][x] === 3) {
                if (gameState.keysCollected >= 5) {
                    winGame();
                } else {
                    // Show message that more keys are needed
                    showTemporaryMessage(`You need ${5 - gameState.keysCollected} more keys to reach the treasure!`);
                }
            }
        }

        // Show Question Modal
        function showQuestion(subject, keyIndex) {
            const questions = questionsDB[subject];
            const question = questions[Math.floor(Math.random() * questions.length)];
            
            gameState.currentQuestion = {
                question: question,
                subject: subject,
                keyIndex: keyIndex,
                selectedOption: null
            };
            
            const modal = document.getElementById('questionModal');
            const subjectEl = document.getElementById('questionSubject');
            const textEl = document.getElementById('questionText');
            const optionsEl = document.getElementById('optionsContainer');
            const submitBtn = document.getElementById('submitAnswer');
            
            subjectEl.textContent = subject;
            textEl.textContent = question.question;
            
            // Create options
            optionsEl.innerHTML = '';
            question.options.forEach((option, index) => {
                const optionEl = document.createElement('div');
                optionEl.className = 'option';
                optionEl.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionEl.onclick = () => selectOption(index, optionEl);
                optionsEl.appendChild(optionEl);
            });
            
            submitBtn.disabled = true;
            modal.classList.add('show');
        }

        // Select Option
        function selectOption(index, element) {
            // Remove previous selection
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            
            // Add new selection
            element.classList.add('selected');
            gameState.currentQuestion.selectedOption = index;
            
            document.getElementById('submitAnswer').disabled = false;
        }

        // Submit Answer
        function submitAnswer() {
            const { question, selectedOption, keyIndex } = gameState.currentQuestion;
            const isCorrect = selectedOption === question.correct;
            
            gameState.questionsAnswered++;
            if (isCorrect) {
                gameState.correctAnswers++;
                gameState.score += 100;
                collectKey(keyIndex);
                showAnswerFeedback(true);
            } else {
                gameState.score = Math.max(0, gameState.score - 25);
                showAnswerFeedback(false);
            }
            
            setTimeout(() => {
                document.getElementById('questionModal').classList.remove('show');
                updateUI();
            }, 2000);
        }

        // Show Answer Feedback
        function showAnswerFeedback(isCorrect) {
            const options = document.querySelectorAll('.option');
            const correctIndex = gameState.currentQuestion.question.correct;
            
            options.forEach((option, index) => {
                if (index === correctIndex) {
                    option.classList.add('correct');
                } else if (index === gameState.currentQuestion.selectedOption && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });
            
            document.getElementById('submitAnswer').style.display = 'none';
            document.getElementById('skipQuestion').textContent = isCorrect ? 'Continue' : 'Continue';
        }

        // Skip Question
        function skipQuestion() {
            document.getElementById('questionModal').classList.remove('show');
            updateUI();
        }

        // Collect Key
        function collectKey(keyIndex) {
            const key = gameState.keys[keyIndex];
            key.collected = true;
            gameState.keysCollected++;
            
            const keyElement = document.getElementById(`key-${key.x}-${key.y}`);
            keyElement.classList.add('collected');
            
            setTimeout(() => {
                keyElement.remove();
            }, 500);
            
            // Create celebration effect
            createCelebrationEffect();
        }

        // Create Celebration Effect
        function createCelebrationEffect() {
            const colors = ['#FFC107', '#FFD700', '#FF8F00', '#10b981', '#3b82f6'];
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 50);
            }
        }

        // Win Game
        function winGame() {
            gameState.gameWon = true;
            const endTime = Date.now();
            const totalTime = Math.floor((endTime - gameState.startTime) / 1000);
            const accuracy = gameState.questionsAnswered > 0 ? 
                Math.round((gameState.correctAnswers / gameState.questionsAnswered) * 100) : 0;
            
            document.getElementById('finalKeys').textContent = gameState.keysCollected;
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('finalTime').textContent = formatTime(totalTime);
            document.getElementById('finalAccuracy').textContent = accuracy;
            
            document.getElementById('successModal').classList.add('show');
            
            // Create massive celebration
            for (let i = 0; i < 100; i++) {
                setTimeout(() => createCelebrationEffect(), i * 50);
            }
        }

        // Start Game Timer
        function startGameTimer() {
            gameState.startTime = Date.now();
            
            setInterval(() => {
                if (!gameState.gameWon) {
                    const currentTime = Date.now();
                    gameState.gameTime = Math.floor((currentTime - gameState.startTime) / 1000);
                    document.getElementById('gameTime').textContent = formatTime(gameState.gameTime);
                }
            }, 1000);
        }

        // Format Time
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        // Update UI
        function updateUI() {
            document.getElementById('keysCollected').textContent = gameState.keysCollected;
            document.getElementById('gameScore').textContent = gameState.score;
        }

        // Show Temporary Message
        function showTemporaryMessage(message) {
            const messageEl = document.createElement('div');
            messageEl.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(239, 68, 68, 0.9);
                color: white;
                padding: 1rem 2rem;
                border-radius: 10px;
                font-size: 1.2rem;
                z-index: 150;
                animation: fadeInOut 3s ease-in-out;
            `;
            messageEl.textContent = message;
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.remove();
            }, 3000);
        }

        // Restart Game
        function restartGame() {
            gameState = {
                player: { x: 0, y: 0 },
                keys: [],
                keysCollected: 0,
                score: 0,
                startTime: null,
                gameTime: 0,
                currentQuestion: null,
                questionsAnswered: 0,
                correctAnswers: 0,
                gameWon: false
            };
            
            document.getElementById('successModal').classList.remove('show');
            initGame();
        }

        // Go Home
        function goHome() {
            window.location.href = 'index.html';
        }

        // Keyboard Controls
        document.addEventListener('keydown', (e) => {
            if (document.getElementById('questionModal').classList.contains('show') || 
                document.getElementById('successModal').classList.contains('show')) {
                return;
            }
            
            switch (e.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    e.preventDefault();
                    movePlayer('up');
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    e.preventDefault();
                    movePlayer('down');
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    e.preventDefault();
                    movePlayer('left');
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    e.preventDefault();
                    movePlayer('right');
                    break;
            }
        });

        // Mobile Controls
        document.querySelectorAll('.control-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const direction = btn.dataset.direction;
                movePlayer(direction);
            });
        });

        // Modal Event Listeners
        document.getElementById('submitAnswer').addEventListener('click', submitAnswer);
        document.getElementById('skipQuestion').addEventListener('click', skipQuestion);

        // Navigation Toggle
        const navToggle = document.getElementById('navToggle');
        const navLinks = document.getElementById('navLinks');

        navToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            navToggle.innerHTML = navLinks.classList.contains('active') ? '✕' : '☰';
        });

        navLinks.addEventListener('click', (e) => {
            if (e.target.tagName === 'A') {
                navLinks.classList.remove('active');
                navToggle.innerHTML = '☰';
            }
        });

        document.addEventListener('click', (e) => {
            if (!navToggle.contains(e.target) && !navLinks.contains(e.target)) {
                navLinks.classList.remove('active');
                navToggle.innerHTML = '☰';
            }
        });

        // Loading Screen
        function initLoadingScreen() {
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
                setTimeout(() => {
                    initGame();
                }, 500);
            }, 4000);
        }

        // Initialize Game on Load
        document.addEventListener('DOMContentLoaded', () => {
            initLoadingScreen();
        });

        // Add CSS animation for temporary message
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInOut {
                0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                20%, 80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
